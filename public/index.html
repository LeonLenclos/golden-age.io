<!DOCTYPE html>
<html>
<head>
  <title>Golden Age</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <main id="app">

    <start
    v-if="!started"
    @start="started=true"
    ></start>
    <loading
      v-else-if="loading<1"
      :progress="loading"
      ></loading>
    <join-room
      v-else-if="!room"
      @join_room="join_room"
      ></join-room>

    <header>
      <room
      v-if=room
      :room=room
      @quit_room=quit_room
      ></room>
    </header>

    <main>

      <aside>
        <messages
        :messages="messages"
        @send_message="send_message"
        ></messages>
        <inspector
        :pos=inspected_pos
        :entities="room?.world?.entities.filter(e=>e.pos.x==inspected_pos.x && e.pos.y==inspected_pos.y)"
        ></inspector>
      </aside>

      <main-map
      ref=map
      :players="room?.players"
      :world="room?.world"
      :selection=selection
      @inspect=inspect
      @select=select
      @target=target
      ></main-map>

      <aside>
        <div class="panel"
        id="selection"
        v-if=room
        >
        <div class="selection-actions">
          <button
            @click="unselect()"
            :disabled="selection==undefined"
          >unselect <span class="shortcut">space</span></button>
          <button
          @click="select_next()"
        >select next<span class="shortcut">tab</span></button>
        </div>
        <selection
          :selection="what_is(selection)"
          :creations="what_is(selection)?.creations"
          :mission="what_is(selection)?.mission"
          @creation=creation
          ></selection>
      </div>
  
      </aside>

    </main>

    <footer>

    </footer>
  </main>
  <script src="/socket.io/socket.io.js"></script>
  <script src="js/lib/howler.js"></script>
  <script src="js/lib/vector.js"></script>
  <script src="js/lib/cookies.js"></script>
  <script src="js/lib/vue.js"></script>
  <script src="js/components.js"></script>
  <script src="js/map.js"></script>
  <script src="js/main.js"></script>
  <script src="js/map.js"></script>
</body>
</html>
